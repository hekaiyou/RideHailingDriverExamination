<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜åŸ¹è®­ç³»ç»Ÿ</title>
  <!-- Tailwind Play CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-500 via-purple-600 to-purple-700 font-sans antialiased">
  <div class="container mx-auto max-w-3xl bg-white min-h-screen relative shadow-xl">
    <!-- ç™»å½•é¡µé¢ -->
    <div id="loginPage" class="login-page flex items-center justify-center min-h-screen p-6">
      <div class="w-full">
        <div class="login-header text-center mb-8">
          <h1 class="text-gray-800 text-2xl font-semibold">é•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜åŸ¹è®­ç³»ç»Ÿ</h1>
        </div>
        <div class="login-form mx-auto w-full max-w-md bg-white p-8 rounded-xl shadow-lg">
          <div class="form-group mb-6">
            <label for="idCard" class="block text-sm font-medium text-gray-700 mb-2">èº«ä»½è¯å·</label>
            <input type="text" id="idCard" placeholder="è¯·è¾“å…¥èº«ä»½è¯å·"
                   class="w-full p-3 border-2 border-gray-200 rounded-md text-base focus:outline-none focus:border-indigo-500" />
          </div>
          <div class="form-group mb-6">
            <label for="password" class="block text-sm font-medium text-gray-700 mb-2">å¯†ç </label>
            <input type="password" id="password" placeholder="è¯·è¾“å…¥å¯†ç "
                   class="w-full p-3 border-2 border-gray-200 rounded-md text-base focus:outline-none focus:border-indigo-500" />
            <div class="password-hint text-red-500 text-xs mt-2">å¯†ç é»˜è®¤èº«ä»½è¯å·åå…­ä½</div>
          </div>
          <button class="login-btn w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-base font-medium"
                  onclick="login()">ç¡®è®¤</button>
        </div>
      </div>
    </div>

    <!-- ä¸»é¡µé¢ -->
    <div id="mainPage" class="main-page" style="display:none;">
      <div class="header bg-indigo-600 text-white p-4 text-center">
        <h1 class="text-lg font-semibold">é•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜åŸ¹è®­ç³»ç»Ÿ</h1>
      </div>

      <div class="tab-nav flex bg-gray-100 border-b border-gray-200">
        <button onclick="showTab('courses','thisBtn1')" data-name="courses"
                class="tab-item tab-btn-1 flex-1 py-3 text-center cursor-pointer text-indigo-600 bg-white border-b-2 border-indigo-600 font-semibold">
          æˆ‘çš„è¯¾ç¨‹
        </button>
        <button onclick="showTab('profile', 'thisBtn2')" data-name="profile"
                class="tab-item tab-btn-2 flex-1 py-3 text-center cursor-pointer text-gray-600">
          ä¸ªäººä¸­å¿ƒ
        </button>
      </div>

      <div class="tab-content p-5 min-h-[calc(100vh-120px)]">
        <!-- æˆ‘çš„è¯¾ç¨‹ -->
        <div id="coursesTab" class="tab-pane block">
          <div class="space-y-4">
            <div class="course-item flex items-center p-5 bg-white rounded-xl shadow-md cursor-pointer transform hover:-translate-y-1 transition"
                 onclick="enterCourse('regional')">
              <div class="course-image flex-shrink-0 w-28 h-28 rounded-xl mr-5 flex items-center justify-center text-4xl bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-lg">ğŸš—</div>
              <div class="course-title flex-1 text-gray-800 text-base leading-relaxed">
                é•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜<span class="text-red-500">åŒºåŸŸç§‘ç›®</span>ä»ä¸šèµ„æ ¼åŸ¹è®­
              </div>
            </div>

            <div class="course-item flex items-center p-5 bg-white rounded-xl shadow-md cursor-pointer transform hover:-translate-y-1 transition"
                 onclick="enterCourse('public')">
              <div class="course-image flex-shrink-0 w-28 h-28 rounded-xl mr-5 flex items-center justify-center text-4xl bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-lg">ğŸš•</div>
              <div class="course-title flex-1 text-gray-800 text-base leading-relaxed">
                é•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜<span class="text-red-500">å…¬å…±ç§‘ç›®</span>ä»ä¸šèµ„æ ¼åŸ¹è®­
              </div>
            </div>
          </div>
        </div>

        <!-- ä¸ªäººä¸­å¿ƒ -->
        <div id="profileTab" class="tab-pane hidden">
          <div class="profile-info bg-white rounded-xl p-6 shadow-md mb-4">
            <div class="profile-item flex justify-between py-3 border-b border-gray-100">
              <span class="profile-label font-semibold text-gray-800">å§“å</span>
              <span class="profile-value text-gray-600" id="userName">å¼ ä¸‰</span>
            </div>
            <div class="profile-item flex justify-between py-3 border-b border-gray-100">
              <span class="profile-label font-semibold text-gray-800">èº«ä»½è¯å·</span>
              <span class="profile-value text-gray-600" id="userIdCard"></span>
            </div>
            <div class="profile-item flex justify-between py-3">
              <span class="profile-label font-semibold text-gray-800">ä»ä¸šç±»å‹</span>
              <span class="profile-value text-gray-600">ç½‘ç»œé¢„çº¦å‡ºç§Ÿæ±½è½¦é©¾é©¶å‘˜</span>
            </div>
          </div>
          <button class="logout-btn w-full py-3 bg-red-500 hover:bg-red-600 text-white rounded-md" onclick="logout()">é€€å‡ºç™»å½•</button>
        </div>
      </div>
    </div>

    <!-- è¯¾ç¨‹å­¦ä¹ é¡µé¢ -->
    <div id="studyPage" class="study-page" style="display:none;">
      <button class="back-btn absolute top-5 left-5 bg-gray-600 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-700"
              onclick="backToMain()">â†</button>

      <div class="header bg-indigo-600 text-white p-4 text-center">
        <h1 id="courseTitle" class="text-lg font-semibold">è¯¾ç¨‹å­¦ä¹ </h1>
      </div>

      <div class="tab-content p-5">
        <div class="study-modules grid grid-cols-1 gap-4">
          <div class="module-item bg-white rounded-xl p-6 shadow-md text-center cursor-pointer transform hover:-translate-y-1 transition"
               onclick="startPractice()">
            <div class="module-icon w-14 h-14 bg-indigo-600 rounded-full mx-auto flex items-center justify-center text-white text-xl mb-4">ğŸ“</div>
            <h3 class="text-gray-800 font-medium">é¡ºåºç»ƒä¹ </h3>
          </div>

          <div class="module-item bg-white rounded-xl p-6 shadow-md text-center cursor-pointer transform hover:-translate-y-1 transition"
               onclick="showExamRules()">
            <div class="module-icon w-14 h-14 bg-indigo-600 rounded-full mx-auto flex items-center justify-center text-white text-xl mb-4">ğŸ“‹</div>
            <h3 class="text-gray-800 font-medium">æ¨¡æ‹Ÿè€ƒè¯•</h3>
          </div>

          <div class="module-item bg-white rounded-xl p-6 shadow-md text-center cursor-pointer transform hover:-translate-y-1 transition"
               onclick="showWrongQuestions()">
            <div class="module-icon w-14 h-14 bg-indigo-600 rounded-full mx-auto flex items-center justify-center text-white text-xl mb-4">âŒ</div>
            <h3 class="text-gray-800 font-medium">æˆ‘çš„é”™é¢˜</h3>
          </div>
        </div>
      </div>
    </div>

    <!-- è€ƒè¯•è§„åˆ™é¡µé¢ -->
    <div id="examRulesPage" class="exam-page" style="display:none;">
      <button class="back-btn absolute top-5 left-5 bg-gray-600 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-700"
              onclick="backToStudy()">â†</button>

      <div class="tab-content p-5">
        <div class="exam-rules bg-white rounded-xl p-8 shadow-md text-center">
          <h2 class="text-gray-800 text-xl font-semibold mb-4">æ¨¡æ‹Ÿè€ƒè¯•è§„åˆ™</h2>
          <ol class="rules-list text-left space-y-3 mb-4">
            <li class="bg-gray-50 p-3 rounded-md">è€ƒè¯•ç§‘ç›®ï¼šé•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜åŒºåŸŸç§‘ç›®ä»ä¸šèµ„æ ¼åŸ¹è®­æ¨¡æ‹Ÿè€ƒè¯•</li>
            <li class="bg-gray-50 p-3 rounded-md">è¯•é¢˜æ•°é‡ï¼š50é¢˜</li>
            <li class="bg-gray-50 p-3 rounded-md">è€ƒè¯•æ—¶é—´ï¼š60åˆ†é’Ÿ</li>
            <li class="bg-gray-50 p-3 rounded-md">é€šè¿‡æ ‡å‡†ï¼šæ»¡åˆ†50åˆ†ï¼Œ40åˆ†é€šè¿‡</li>
          </ol>
          <button class="start-exam-btn mt-3 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-md" onclick="startExam()">å¼€å§‹æ¨¡æ‹Ÿè€ƒè¯•</button>
        </div>
      </div>
    </div>

    <!-- é¡ºåºç»ƒä¹ é¡µé¢ -->
    <div id="practicePage" class="practice-page" style="display:none;">
      <button class="back-btn absolute top-5 left-5 bg-gray-600 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-700"
              onclick="backToStudy()">â†</button>

      <div class="question-container bg-white rounded-xl p-5 m-5 shadow-md">
        <div class="question-header flex justify-between items-center mb-4 pb-2 border-b border-gray-100">
          <span class="question-number text-indigo-600 font-semibold" id="practiceQuestionNum">ç¬¬1é¢˜/å…±500é¢˜</span>
          <span class="question-type bg-indigo-600 text-white px-3 py-1 rounded-full text-xs" id="practiceQuestionType">å•é€‰é¢˜</span>
        </div>
        <div class="question-text text-gray-800 text-base leading-relaxed mb-4" id="practiceQuestionText"></div>
        <ul class="options space-y-3" id="practiceOptions"></ul>
      </div>

      <div class="controls flex flex-wrap gap-3 justify-between items-center p-5 m-5 bg-white rounded-xl shadow-md">
        <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="previousQuestion('practice')">ä¸Šä¸€é¢˜</button>
        <button class="btn btn-danger px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-md" onclick="endPractice()">ç»“æŸç»ƒä¹ </button>
        <button class="btn btn-primary px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md" onclick="nextQuestion('practice')">ä¸‹ä¸€é¢˜</button>
        <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="showQuestionSelector('practice')">é€‰é¢˜</button>
        <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="redoQuestion('practice')">é‡åš</button>
      </div>
    </div>

    <!-- æ¨¡æ‹Ÿè€ƒè¯•é¡µé¢ -->
    <div id="examPage" class="exam-page" style="display:none;">
      <button class="back-btn absolute top-5 left-5 bg-gray-600 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-700"
              onclick="backToStudy()">â†</button>

      <div class="question-container bg-white rounded-xl p-5 m-5 shadow-md">
        <div class="question-header flex justify-between items-center mb-4 pb-2 border-b border-gray-100">
          <span class="question-number text-indigo-600 font-semibold" id="examQuestionNum">ç¬¬1é¢˜/å…±50é¢˜</span>
          <span class="question-type bg-indigo-600 text-white px-3 py-1 rounded-full text-xs" id="examQuestionType">å•é€‰é¢˜</span>
        </div>
        <div class="question-text text-gray-800 text-base leading-relaxed mb-4" id="examQuestionText"></div>
        <ul class="options space-y-3" id="examOptions"></ul>
      </div>

      <div class="controls flex flex-wrap gap-3 justify-between items-center p-5 m-5 bg-white rounded-xl shadow-md">
        <div class="flex gap-2">
          <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="previousQuestion('exam')">ä¸Šä¸€é¢˜</button>
          <button class="btn btn-primary px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md" onclick="nextQuestion('exam')">ä¸‹ä¸€é¢˜</button>
          <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="showQuestionSelector('exam')">é€‰é¢˜</button>
        </div>
        <div class="flex items-center gap-3">
          <div class="timer text-red-600 font-semibold" id="examTimer">60:00</div>
          <button class="btn btn-danger px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-md" onclick="submitExam()">äº¤å·</button>
        </div>
      </div>
    </div>

    <!-- æˆ‘çš„é”™é¢˜é¡µé¢ -->
    <div id="wrongPage" class="wrong-page" style="display:none;">
      <button class="back-btn absolute top-5 left-5 bg-gray-600 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-700"
              onclick="backToStudy()">â†</button>

      <div class="question-container bg-white rounded-xl p-5 m-5 shadow-md">
        <div class="question-header flex justify-between items-center mb-4 pb-2 border-b border-gray-100">
          <span class="question-number text-indigo-600 font-semibold" id="wrongQuestionNum">ç¬¬1é¢˜/å…±0é¢˜</span>
          <span class="question-type bg-indigo-600 text-white px-3 py-1 rounded-full text-xs" id="wrongQuestionType">å•é€‰é¢˜</span>
        </div>
        <div class="question-text text-gray-600 text-base leading-relaxed mb-4" id="wrongQuestionText">æš‚æ— é”™é¢˜</div>
        <ul class="options space-y-3" id="wrongOptions"></ul>
      </div>

      <div class="controls flex flex-wrap gap-3 justify-between items-center p-5 m-5 bg-white rounded-xl shadow-md">
        <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="previousQuestion('wrong')">ä¸Šä¸€é¢˜</button>
        <button class="btn btn-primary px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md" onclick="nextQuestion('wrong')">ä¸‹ä¸€é¢˜</button>
        <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="showQuestionSelector('wrong')">é€‰é¢˜</button>
        <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="redoQuestion('wrong')">é‡åš</button>
      </div>
    </div>
  </div>

  <!-- é€‰é¢˜å¼¹çª— -->
  <div id="questionModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center" style="display:none;">
    <div class="modal-content bg-white rounded-xl p-6 max-w-2xl w-11/12 max-h-[80vh] overflow-hidden shadow-2xl">
      <h3 class="text-center text-lg font-semibold text-gray-800">é€‰æ‹©é¢˜ç›®</h3>
      <div id="questionSelector" class="question-selector grid grid-cols-10 gap-2 mt-4 p-2 bg-gray-50 rounded-md overflow-y-auto" style="max-height:50vh;"></div>
      <div class="text-center mt-4">
        <button class="btn btn-secondary px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md" onclick="closeModal()">å…³é—­</button>
      </div>
    </div>
  </div>

  <!-- ç¡®è®¤å¼¹çª— -->
  <div id="confirmModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center" style="display:none;">
    <div class="modal-content bg-white rounded-xl p-6 max-w-lg w-11/12 shadow-2xl">
      <h3 id="confirmTitle" class="text-center text-lg font-semibold text-gray-800">ç¡®è®¤</h3>
      <p id="confirmMessage" class="text-center text-gray-700 mt-3"></p>
      <div class="text-center mt-6">
        <button class="btn btn-secondary px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-md mr-3" onclick="closeModal()">å–æ¶ˆ</button>
        <button class="btn btn-primary px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md" id="confirmBtn">ç¡®å®š</button>
      </div>
    </div>
  </div>

  <!-- æˆç»©å¼¹çª— -->
  <div id="resultModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center" style="display:none;">
    <div class="modal-content bg-white rounded-xl p-6 max-w-lg w-11/12 shadow-2xl">
      <h3 class="text-center text-lg font-semibold text-gray-800">è€ƒè¯•æˆç»©</h3>
      <div id="examResult" class="mt-4"></div>
      <div class="text-center mt-6">
        <button class="btn btn-primary px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md" onclick="closeModal()">ç¡®å®š</button>
      </div>
    </div>
  </div>

  <style>
    /* ä¸ºé€‰é¢˜æŒ‰é’®ä¿ç•™è¯­ä¹‰ç±»ï¼Œä½¿ç”¨ Tailwind çš„è§†è§‰æ ·å¼é€šè¿‡ JS åˆ‡æ¢ */
    .question-num { /* base styles complement Tailwind defaults */
      padding: 10px 8px;
      text-align: center;
      border: 2px solid #e6e6e6;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      min-height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .question-num.current { background-color:#4f46e5; color:white; border-color:#4f46e5; box-shadow: 0 8px 20px rgba(79,70,229,0.25); }
    .question-num.answered { background-color:#16a34a; color:white; border-color:#16a34a; }
    .question-num.wrong { background-color:#ef4444; color:white; border-color:#ef4444; }
    /* é€‰é¡¹åŸºç±»ï¼ˆJS ä¼šå¢åŠ  correct/wrong/selectedï¼‰ */
    .option { padding: 12px; border: 2px solid #eee; border-radius: 8px; cursor: pointer; transition: all .2s; }
    .option.selected { border-color:#4f46e5; background:#f8f9ff; }
    .option.correct { border-color:#16a34a; background:#dff7ea; color:#166534; }
    .option.wrong { border-color:#ef4444; background:#fff2f2; color:#b91c1c; }
  </style>

  <script>
    // å…¨å±€å˜é‡
    let currentUser = null;
    let currentCourse = null;
    let currentMode = null; // 'practice', 'exam', 'wrong'
    let currentQuestionIndex = 0;
    let questions = [];
    let userAnswers = [];
    let wrongQuestions = JSON.parse(localStorage.getItem('wrongQuestions') || '[]');
    let examTimer = null;
    let examTimeLeft = 3600; // 60åˆ†é’Ÿ

    // æ¨¡æ‹Ÿå­¦å‘˜æ•°æ®
    const students = [
      { idCard: '430102199001011234', name: 'å¼ ä¸‰' },
      { idCard: '430102199002021234', name: 'æå››' },
      { idCard: '430102199003031234', name: 'ç‹äº”' }
    ];

    // é¢˜åº“æ•°æ®
    const questionBank = {
      practice: generateQuestions(500),
      exam: generateQuestions(50)
    };

    function generateQuestions(count) {
      const questions = [];
      const questionTypes = ['å•é€‰é¢˜', 'åˆ¤æ–­é¢˜'];

      for (let i = 0; i < count; i++) {
        const type = questionTypes[Math.floor(Math.random() * questionTypes.length)];
        let question;

        if (type === 'å•é€‰é¢˜') {
          question = {
            id: i + 1,
            type: type,
            text: `å…³äºç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜çš„ç›¸å…³è§„å®šï¼Œä»¥ä¸‹å“ªé¡¹æ˜¯æ­£ç¡®çš„ï¼Ÿ`,
            options: [
              'Aï¼šéœ€è¦å–å¾—ç›¸åº”çš„ä»ä¸šèµ„æ ¼è¯',
              'Bï¼šä¸éœ€è¦ä»»ä½•è¯ä»¶',
              'Cï¼šåªéœ€è¦é©¾é©¶è¯',
              'Dï¼šåªéœ€è¦èº«ä»½è¯'
            ],
            correctAnswer: 0
          };
        } else {
          question = {
            id: i + 1,
            type: type,
            text: `ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜å¿…é¡»å–å¾—ä»ä¸šèµ„æ ¼è¯æ‰èƒ½ä»äº‹ç›¸å…³å·¥ä½œã€‚`,
            options: [
              'æ­£ç¡®',
              'é”™è¯¯'
            ],
            correctAnswer: 0
          };
        }

        questions.push(question);
      }

      return questions;
    }

    // ç™»å½•åŠŸèƒ½
    function login() {
      const idCard = document.getElementById('idCard').value.trim();
      const password = document.getElementById('password').value.trim();

      if (!idCard || !password) {
        alert('è¯·è¾“å…¥èº«ä»½è¯å·å’Œå¯†ç ');
        return;
      }

      if (!/^\d{18}$/.test(idCard)) {
        alert('è¯·è¾“å…¥æ­£ç¡®çš„18ä½èº«ä»½è¯å·');
        return;
      }

      const student = students.find(s => s.idCard === idCard);
      if (!student) {
        alert('èº«ä»½è¯å·ä¸å­˜åœ¨ï¼Œè¯·è”ç³»ç®¡ç†å‘˜');
        return;
      }

      const expectedPassword = idCard.slice(-6);
      if (password !== expectedPassword) {
        alert('å¯†ç é”™è¯¯ï¼Œå¯†ç ä¸ºèº«ä»½è¯å·åå…­ä½');
        return;
      }

      currentUser = student;
      document.getElementById('userIdCard').textContent = idCard;
      document.getElementById('userName').textContent = student.name;

      document.getElementById('loginPage').style.display = 'none';
      document.getElementById('mainPage').style.display = 'block';
    }

    // é€€å‡ºç™»å½•
    function logout() {
      currentUser = null;
      currentCourse = null;
      document.getElementById('loginPage').style.display = 'flex';
      document.getElementById('mainPage').style.display = 'none';
      document.getElementById('studyPage').style.display = 'none';
      document.getElementById('practicePage').style.display = 'none';
      document.getElementById('examPage').style.display = 'none';
      document.getElementById('examRulesPage').style.display = 'none';
      document.getElementById('wrongPage').style.display = 'none';
      document.getElementById('idCard').value = '';
      document.getElementById('password').value = '';
    }

    // åˆ‡æ¢æ ‡ç­¾é¡µï¼ˆä¿®æ”¹ï¼šåˆ‡æ¢ Tailwind ç±»ï¼‰
    function showTab(tabName, btnRef) {
      // éšè—æ‰€æœ‰ tab-pane
      document.querySelectorAll('.tab-pane').forEach(p => {
        p.classList.add('hidden');
        p.classList.remove('block');
      });

      // æ¢å¤æ‰€æœ‰ tab-item æ ·å¼ä¸ºä¸æ¿€æ´»
      document.querySelectorAll('.tab-item').forEach(btn => {
        btn.classList.remove('text-indigo-600','bg-white','border-b-2','border-indigo-600','font-semibold');
        btn.classList.add('text-gray-600');
      });

      // æ˜¾ç¤ºç›®æ ‡ Pane
      const pane = document.getElementById(tabName + 'Tab');
      if (pane) {
        pane.classList.remove('hidden');
        pane.classList.add('block');
      }

      // æ¿€æ´»å½“å‰æŒ‰é’®ï¼šå› ä¸ºonclick ä¼ å…¥çš„ä¸ºå­—ç¬¦ä¸²æ ‡è®°ï¼Œä¸Šé¢æˆ‘ä»¬æ— æ³•å–å¾—å®é™… element å¼•ç”¨ï¼Œ
      // æ‰€ä»¥é€šè¿‡æ¯”è¾ƒ data-name æ‰¾åˆ°å¯¹åº”æŒ‰é’®å¹¶æ¿€æ´»ï¼ˆæ›´ç¨³å¥ï¼‰
      document.querySelectorAll('.tab-item').forEach(btn => {
        if ((btn.getAttribute('data-name') || btn.dataset.name) === tabName) {
          btn.classList.add('text-indigo-600','bg-white','border-b-2','border-indigo-600','font-semibold');
          btn.classList.remove('text-gray-600');
        }
      });
    }

    // è¿›å…¥è¯¾ç¨‹
    function enterCourse(courseType) {
      currentCourse = courseType;
      const titles = {
        regional: 'é•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜åŒºåŸŸç§‘ç›®ä»ä¸šèµ„æ ¼åŸ¹è®­',
        public: 'é•¿æ²™å¸‚ç½‘ç»œé¢„çº¦å‡ºç§Ÿè½¦é©¾é©¶å‘˜å…¬å…±ç§‘ç›®ä»ä¸šèµ„æ ¼åŸ¹è®­'
      };

      document.getElementById('courseTitle').textContent = titles[courseType];
      document.getElementById('mainPage').style.display = 'none';
      document.getElementById('studyPage').style.display = 'block';
    }

    // è¿”å›ä¸»é¡µ
    function backToMain() {
      document.getElementById('studyPage').style.display = 'none';
      document.getElementById('mainPage').style.display = 'block';
    }

    // è¿”å›å­¦ä¹ é¡µ
    function backToStudy() {
      document.getElementById('practicePage').style.display = 'none';
      document.getElementById('examPage').style.display = 'none';
      document.getElementById('examRulesPage').style.display = 'none';
      document.getElementById('wrongPage').style.display = 'none';
      document.getElementById('studyPage').style.display = 'block';
      if (examTimer) {
        clearInterval(examTimer);
        examTimer = null;
      }
    }

    // å¼€å§‹é¡ºåºç»ƒä¹ 
    function startPractice() {
      currentMode = 'practice';
      questions = [...questionBank.practice];
      userAnswers = new Array(questions.length).fill(null);
      currentQuestionIndex = 0;
      document.getElementById('studyPage').style.display = 'none';
      document.getElementById('practicePage').style.display = 'block';
      showQuestion('practice');
    }

    // æ˜¾ç¤ºè€ƒè¯•è§„åˆ™
    function showExamRules() {
      document.getElementById('studyPage').style.display = 'none';
      document.getElementById('examRulesPage').style.display = 'block';
    }

    // å¼€å§‹æ¨¡æ‹Ÿè€ƒè¯•
    function startExam() {
      currentMode = 'exam';
      questions = [...questionBank.exam];
      userAnswers = new Array(questions.length).fill(null);
      currentQuestionIndex = 0;
      examTimeLeft = 3600;
      document.getElementById('examRulesPage').style.display = 'none';
      document.getElementById('examPage').style.display = 'block';
      showQuestion('exam');
      startExamTimer();
    }

    // å¼€å§‹è€ƒè¯•è®¡æ—¶å™¨
    function startExamTimer() {
      if (examTimer) clearInterval(examTimer);
      examTimer = setInterval(() => {
        examTimeLeft--;
        const minutes = Math.floor(examTimeLeft / 60);
        const seconds = examTimeLeft % 60;
        document.getElementById('examTimer').textContent =
          `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        if (examTimeLeft <= 0) {
          clearInterval(examTimer);
          examTimer = null;
          submitExam(true);
        }
      }, 1000);
    }

    // æ˜¾ç¤ºé”™é¢˜
    function showWrongQuestions() {
      if (wrongQuestions.length === 0) {
        alert('æš‚æ— é”™é¢˜');
        return;
      }
      currentMode = 'wrong';
      questions = [...wrongQuestions];
      userAnswers = new Array(questions.length).fill(null);
      currentQuestionIndex = 0;
      document.getElementById('studyPage').style.display = 'none';
      document.getElementById('wrongPage').style.display = 'block';
      showQuestion('wrong');
    }

    // æ˜¾ç¤ºé¢˜ç›®
    function showQuestion(mode) {
      if (questions.length === 0) return;
      const question = questions[currentQuestionIndex];
      const prefix = mode === 'practice' ? 'practice' : mode === 'exam' ? 'exam' : 'wrong';
      document.getElementById(prefix + 'QuestionNum').textContent =
        `ç¬¬${currentQuestionIndex + 1}é¢˜/å…±${questions.length}é¢˜`;
      document.getElementById(prefix + 'QuestionType').textContent = question.type;
      document.getElementById(prefix + 'QuestionText').textContent = question.text;
      const optionsContainer = document.getElementById(prefix + 'Options');
      optionsContainer.innerHTML = '';
      question.options.forEach((option, index) => {
        const li = document.createElement('li');
        li.className = 'option bg-white';
        li.textContent = option;
        li.onclick = () => selectOption(mode, index);
        if (userAnswers[currentQuestionIndex] !== null) {
          if (index === userAnswers[currentQuestionIndex]) {
            li.classList.add('selected');
          }
        }
        optionsContainer.appendChild(li);
      });
    }

    // é€‰æ‹©é€‰é¡¹
    function selectOption(mode, optionIndex) {
      const question = questions[currentQuestionIndex];
      const prefix = mode === 'practice' ? 'practice' : mode === 'exam' ? 'exam' : 'wrong';
      const optionsContainer = document.getElementById(prefix + 'Options');
      optionsContainer.querySelectorAll('.option').forEach(option => {
        option.classList.remove('selected', 'correct', 'wrong');
      });
      userAnswers[currentQuestionIndex] = optionIndex;
      const selectedOption = optionsContainer.children[optionIndex];
      selectedOption.classList.add('selected');
      const isCorrect = optionIndex === question.correctAnswer;
      if (isCorrect) {
        selectedOption.classList.add('correct');
        setTimeout(() => {
          if (mode === 'wrong') {
            removeFromWrongQuestions(question.id);
            questions.splice(currentQuestionIndex, 1);
            userAnswers.splice(currentQuestionIndex, 1);
            if (questions.length === 0) {
              alert('æ­å–œï¼æ‰€æœ‰é”™é¢˜éƒ½å·²å®Œæˆï¼');
              backToStudy();
              return;
            }
            if (currentQuestionIndex >= questions.length) {
              currentQuestionIndex = questions.length - 1;
            }
          } else {
            if (currentQuestionIndex < questions.length - 1) {
              currentQuestionIndex++;
            }
          }
          showQuestion(mode);
        }, 800);
      } else {
        selectedOption.classList.add('wrong');
        const correctOption = optionsContainer.children[question.correctAnswer];
        if (correctOption) correctOption.classList.add('correct');
        addToWrongQuestions(question);
      }
    }

    // æ·»åŠ åˆ°é”™é¢˜é›†
    function addToWrongQuestions(question) {
      const exists = wrongQuestions.find(q => q.id === question.id);
      if (!exists) {
        wrongQuestions.push(question);
        localStorage.setItem('wrongQuestions', JSON.stringify(wrongQuestions));
      }
    }

    // ä»é”™é¢˜é›†ç§»é™¤
    function removeFromWrongQuestions(questionId) {
      wrongQuestions = wrongQuestions.filter(q => q.id !== questionId);
      localStorage.setItem('wrongQuestions', JSON.stringify(wrongQuestions));
    }

    // ä¸Šä¸€é¢˜
    function previousQuestion(mode) {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        showQuestion(mode);
      }
    }

    // ä¸‹ä¸€é¢˜
    function nextQuestion(mode) {
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        showQuestion(mode);
      }
    }

    // é‡åšé¢˜ç›®
    function redoQuestion(mode) {
      userAnswers[currentQuestionIndex] = null;
      showQuestion(mode);
    }

    // ç»“æŸç»ƒä¹ 
    function endPractice() {
      showConfirm('ç¡®è®¤ç»“æŸç»ƒä¹ ï¼Ÿ', () => {
        backToStudy();
      });
    }

    // æäº¤è€ƒè¯•
    function submitExam(autoSubmit = false) {
      const unansweredCount = userAnswers.filter(answer => answer === null).length;
      if (!autoSubmit && unansweredCount > 0) {
        showConfirm(`è¿˜æœ‰${unansweredCount}é“æœªå®Œæˆé¢˜ç›®ï¼Œç¡®å®šæäº¤å—ï¼Ÿ`, () => {
          calculateExamResult();
        });
      } else {
        calculateExamResult();
      }
    }

    // è®¡ç®—è€ƒè¯•æˆç»©
    function calculateExamResult() {
      if (examTimer) {
        clearInterval(examTimer);
        examTimer = null;
      }
      let correctCount = 0;
      questions.forEach((question, index) => {
        if (userAnswers[index] === question.correctAnswer) {
          correctCount++;
        }
      });
      const score = correctCount;
      const passed = score >= 40;
      const resultHtml = `
                <div class="text-center">
                    <h2 style="color: ${passed ? '#16a34a' : '#ef4444'}; font-size:20px; margin-bottom:8px;">
                        ${passed ? 'è€ƒè¯•é€šè¿‡' : 'è€ƒè¯•æœªé€šè¿‡'}
                    </h2>
                    <p style="font-size:24px; margin: 12px 0;">
                        å¾—åˆ†ï¼š<strong>${score}</strong>/50
                    </p>
                    <p>æ­£ç¡®é¢˜æ•°ï¼š${correctCount}</p>
                    <p>é”™è¯¯é¢˜æ•°ï¼š${questions.length - correctCount}</p>
                    <p>é€šè¿‡æ ‡å‡†ï¼š40åˆ†</p>
                </div>
            `;
      document.getElementById('examResult').innerHTML = resultHtml;
      document.getElementById('resultModal').style.display = 'flex';
    }

    // æ˜¾ç¤ºé€‰é¢˜å¼¹çª—
    function showQuestionSelector(mode) {
      const selector = document.getElementById('questionSelector');
      selector.innerHTML = '';
      questions.forEach((question, index) => {
        const div = document.createElement('div');
        div.className = 'question-num';
        div.textContent = index + 1;
        if (index === currentQuestionIndex) {
          div.classList.add('current');
        } else if (userAnswers[index] !== null) {
          div.classList.add('answered');
        }
        div.onclick = () => {
          currentQuestionIndex = index;
          showQuestion(mode);
          closeModal();
        };
        selector.appendChild(div);
      });
      document.getElementById('questionModal').style.display = 'flex';
    }

    // æ˜¾ç¤ºç¡®è®¤å¼¹çª—
    function showConfirm(message, callback) {
      document.getElementById('confirmMessage').textContent = message;
      document.getElementById('confirmBtn').onclick = () => {
        callback();
        closeModal();
      };
      document.getElementById('confirmModal').style.display = 'flex';
    }

    // å…³é—­å¼¹çª—
    function closeModal() {
      document.querySelectorAll('.modal').forEach(modal => {
        modal.style.display = 'none';
      });
    }

    // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
    document.querySelectorAll('.modal').forEach(modal => {
      modal.onclick = (e) => {
        if (e.target === modal) {
          closeModal();
        }
      };
    });

    document.addEventListener('DOMContentLoaded', function() {
      // åˆå§‹åŒ–ï¼šç¡®ä¿ç¬¬ä¸€ä¸ª tab æ¿€æ´»ï¼ˆåœ¨ DOM ä¸­é»˜è®¤å·²è®¾ç½®ï¼‰
      // è‹¥æƒ³é»˜è®¤æ¿€æ´»å…¶å®ƒ tabï¼Œå¯è°ƒç”¨ showTab('profile')
    });
  </script>
</body>
</html>